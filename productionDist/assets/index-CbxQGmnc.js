import{U as m}from"./login-DUxWAo6R.js";import{u as c,b as g,B as l,C as i}from"./index-CyDigk4f.js";const f={__name:"index",setup(p){const o=c();function u(s){const e=document.cookie.split(";");for(let a=0;a<e.length;a++){const t=e[a].split("=");if(s===t[0].trim())return t[1]}return""}const d=(s,n)=>{m.systemUaaAuthGetLoginInfo().then(async e=>{if(e.data.code==200){if(e.data.data.menus.length==0){ElMessage({message:"请先分配菜单！",type:"warning"});return}sessionStorage.setItem("medox-user",JSON.stringify(e.data.data.user)),sessionStorage.setItem("medox-roles",JSON.stringify(e.data.data.roles)),sessionStorage.setItem("medox-menus",JSON.stringify(e.data.data.menus)),sessionStorage.setItem("medox-permCodes",JSON.stringify(e.data.data.permCodes));const a=l(e.data.data.menus.filter(t=>t.menuType==1&&(t.bindType==i.MENU_BIND_TYPE.ROUTE_MENU||t.bindType==i.MENU_BIND_TYPE.EXTERNAL_LINK)));o.options.routes.forEach(t=>{t.name==="layout"&&a.forEach(r=>{o.addRoute("layout",r),t.children.push(r)})}),await o.replace({path:"/home"}),ElMessage({message:"登录成功！",type:"success"})}})};return g(()=>{const s=u("satoken");s!==""&&(sessionStorage.setItem("medox-token-value",s),sessionStorage.setItem("medox-token-name","satoken"),d())}),(s,n)=>null}};export{f as default};
